print(p)
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiPotenza.R")
pivec
library(tibble)
library(ggplot2)
x = seq(1,10,length.out=100)
y = log(x)
x0 = 2
y1 = log(x0) + (1/x0) * (x-x0)
y2 = log(x0) + (1/x0) * (x-x0) - (1/x0^2) * (x-x0)^2/2
y3 = log(x0) + (1/x0) * (x-x0) - (1/x0^2) * (x-x0)^2/2 + (2/x0^3)*(x-x0)^3/6
Tib <- tibble(x=x,Log=y,First=y1,Second=y2,Third=y3)
ntibLong = pivot_longer(Tib,c(Log,First,Second,Third),
names_to = 'Function', values_to = 'Values')
ntibLong$Function <- factor(ntibLong$Function, levels = unique(ntibLong$Function))
p1 <- ggplot(ntibLong, aes(x = x, y = Values, color = Function)) +
geom_line()
mytibLong
ntibLong
rep(pivec,3)
?rep
rep(pivec,each=3)
p1 <- ggplot(ntibLong, aes(x = rep(pivec,each=3), y = Values, color = Function)) +
geom_line()
p1
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiPotenza.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiPotenza.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiPotenza.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiPotenza.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiPotenza.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiPotenza.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiPotenza.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiPotenza.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/resultsPowerHPC.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/resultsPowerHPC.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/resultsPowerHPC.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/resultsPowerHPC.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/resultsPowerHPC.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/resultsPowerHPC.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/resultsPowerHPC.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/resultsPowerHPC.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiPotenza.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiPotenza.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiPotenza.R")
LR <- matrix(scan(paste("c:\\users\\marco.bee\\onedrive\\LognPareto\\ECME\\results\\matrici\\LR_",
n,"_",pivec[i],"_",alphapar,"_0_1_",xmin,".txt",sep="")),byrow=TRUE,ncol = 1)
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiPotenza.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/resultsPowerHPC.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/resultsPowerHPC.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/resultsPowerHPC.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/resultsPowerHPC.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/resultsPowerHPC.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/resultsPowerHPC.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/resultsPowerHPC.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/resultsPowerHPC.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiPotenza.R")
library(CASdatasets)
?brvehins2b
?dev.off
9/45
1.67e5
400*.774
mad
?mad
library(moments)
sk <- skewness(y)
ku <- kurtosis(y)
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(LNPar)
library(CASdatasets)
library(moments)
# BL <- 10 # 20
# dati <- as.matrix(read.csv(paste("g:\\il mio drive\\oldstuff\\paperi\\indinfgh\\operational losses unicredit\\data",BL,".csv",sep="")),header=FALSE) # 60 ok, 50 no, 10 no
# datitutti <- as.double(dati[,1])
# y <- datitutti/1000 # all years, one business line
# data("auscathist")
# y <- auscathist$NormCost2014 # lognormal is better
# data("braggclaim")
# y <- as.double(braggclaim$AggClaim) # estimated desnity is strange
data(brvehins2b)
y <- brvehins2b$ClaimAmountFire
NMA = y[is.na(y)==FALSE]
y = NMA[NMA>0]
# y <- sample(y,200,replace = F)
n <- length(y)
hist(y)
sk <- skewness(y)
ku <- kurtosis(y)
eps = 1e-12
maxiter = 1000
takeOut = 5
nboot = 100
sk
ku
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(LNPar)
library(CASdatasets)
library(moments)
# BL <- 10 # 20
# dati <- as.matrix(read.csv(paste("g:\\il mio drive\\oldstuff\\paperi\\indinfgh\\operational losses unicredit\\data",BL,".csv",sep="")),header=FALSE) # 60 ok, 50 no, 10 no
# datitutti <- as.double(dati[,1])
# y <- datitutti/1000 # all years, one business line
# data("auscathist")
# y <- auscathist$NormCost2014 # lognormal is better
# data("braggclaim")
# y <- as.double(braggclaim$AggClaim) # estimated desnity is strange
data(brvehins2b)
y <- brvehins2b$ClaimAmountFire
NMA = y[is.na(y)==FALSE]
y = NMA[NMA>0]
# y <- sample(y,200,replace = F)
n <- length(y)
hist(y)
sk <- skewness(y)
ku <- kurtosis(y)
eps = 1e-12
maxiter = 1000
nboot = 1000
# lognormal estimates and std
est0 <- c(mean(log(y)),sd(log(y)))
estL = matrix(0,nboot,2)
for (i in 1:nboot)
{
Yboot = sample(y,n,replace=TRUE)
estL[i,] <- c(mean(log(Yboot)),sd(log(Yboot)))
}
sdLogn = apply(estL,2,sd)
madLogn <- apply(estL,2,mad,na.rm=TRUE)
sdLogn
madLogn
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(LNPar)
library(CASdatasets)
library(moments)
data(brvehins2b)
y <- brvehins2b$ClaimAmountFire
NMA = y[is.na(y)==FALSE]
y = NMA[NMA>0]
n <- length(y)
eps = 1e-12
maxiter = 1000
nboot <- 1000
# lognormal estimates and std
est0 <- c(mean(log(y)),sd(log(y)))
estL = matrix(0,nboot,2)
for (i in 1:nboot)
{
Yboot = sample(y,n,replace=TRUE)
estL[i,] <- c(mean(log(Yboot)),sd(log(Yboot)))
}
sdLogn = apply(estL,2,sd)
madLogn <- apply(estL,2,mad,na.rm=TRUE)
# Mix estimates and standard errors
mixFit <- LPfitEM(y,1e-10,maxiter=1000,nboot=0)
bootpars <- matrix(scan("C:/Users/marco.bee/OneDrive/LognPareto/ECME/results/BootparsCat.txt",ncolumns = 5))
?matrix
nboot <- 10000
bootpars <- matrix(scan("C:/Users/marco.bee/OneDrive/LognPareto/ECME/results/BootparsCat.txt"),
nrow=nboot, ncol = 5, byrow = TRUE)
colMeans(bootpars)
trueVaR <- quantile(y,c(.9,.95,.99,.995))
trueVaR
estPars <- mixFit$pars
estPars
?rLnormParMix
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/VaRApp.R")
VaRmat
for (i in 1:10)
{
ysim <- rLnormParMix(nVaR,estPars[1],estPars[3],estPars[4],estPars[5],estPars[2])
VaRmat[i,] <- as.double(quantile(ysim,VaRlev))
}
for (i in 1:nboot)
{
ysim <- rLnormParMix(nVaR,estPars[1],estPars[3],estPars[4],estPars[5],estPars[2])
VaRmat[i,] <- as.double(quantile(ysim,VaRlev))
}
VaRs <- colMeans(VaRmat)
vars
VaRs
EMVaRmat <- matrix(0,nboot,length(VaRlev))
LognVaRmat <- matrix(0,nboot,length(VaRlev))
nVaR <- 10000
for (i in 1:nboot)
{
ymix <- rLnormParMix(nVaR,estPars[1],estPars[3],estPars[4],estPars[5],estPars[2])
ylogn <- rlnorm(nVaR,estL[1],estL[2])
EMVaRmat[i,] <- as.double(quantile(ymix,VaRlev))
LognVaRmat[i,] <- as.double(quantile(ylogn,VaRlev))
}
EMVaRmat
EMVaRs <- colMeans(EMVaRmat)
LognVaRs <- colMeans(LognVaRmat)
EMVaRs
LognVaRs
ylogn
for (i in 1:10)
{
ymix <- rLnormParMix(nVaR,bootPars[i,1],bootPars[i,3],bootPars[i,4],bootPars[i,5],bootPars[i,2])
ylogn <- rlnorm(nVaR,estL[i,1],estL[i,2])
EMVaRmat[i,] <- as.double(quantile(ymix,VaRlev))
LognVaRmat[i,] <- as.double(quantile(ylogn,VaRlev))
}
bootpars <- matrix(scan("C:/Users/marco.bee/OneDrive/LognPareto/ECME/results/BootparsCat.txt"),
nrow=nboot, ncol = 5, byrow = TRUE)
# estPars <- mixFit$pars
VaRlev <- c(.9,.95,.99,.995)
trueVaR <- quantile(y,VaRlev)
EMVaRmat <- matrix(0,nboot,length(VaRlev))
LognVaRmat <- matrix(0,nboot,length(VaRlev))
nVaR <- 10000
for (i in 1:10)
{
ymix <- rLnormParMix(nVaR,bootPars[i,1],bootPars[i,3],bootPars[i,4],bootPars[i,5],bootPars[i,2])
ylogn <- rlnorm(nVaR,estL[i,1],estL[i,2])
EMVaRmat[i,] <- as.double(quantile(ymix,VaRlev))
LognVaRmat[i,] <- as.double(quantile(ylogn,VaRlev))
}
bootPars <- matrix(scan("C:/Users/marco.bee/OneDrive/LognPareto/ECME/results/BootparsCat.txt"),
nrow=nboot, ncol = 5, byrow = TRUE)
# estPars <- mixFit$pars
VaRlev <- c(.9,.95,.99,.995)
trueVaR <- quantile(y,VaRlev)
EMVaRmat <- matrix(0,nboot,length(VaRlev))
LognVaRmat <- matrix(0,nboot,length(VaRlev))
nVaR <- 10000
for (i in 1:10)
{
ymix <- rLnormParMix(nVaR,bootPars[i,1],bootPars[i,3],bootPars[i,4],bootPars[i,5],bootPars[i,2])
ylogn <- rlnorm(nVaR,estL[i,1],estL[i,2])
EMVaRmat[i,] <- as.double(quantile(ymix,VaRlev))
LognVaRmat[i,] <- as.double(quantile(ylogn,VaRlev))
}
EMVaRs <- colMeans(EMVaRmat)
LognVaRs <- colMeans(LognVaRmat)
EMVaRs
LognVaRs
for (i in 1:nboot)
{
ymix <- rLnormParMix(nVaR,bootPars[i,1],bootPars[i,3],bootPars[i,4],bootPars[i,5],bootPars[i,2])
ylogn <- rlnorm(nVaR,estL[i,1],estL[i,2])
EMVaRmat[i,] <- as.double(quantile(ymix,VaRlev))
LognVaRmat[i,] <- as.double(quantile(ylogn,VaRlev))
}
EMVaRs <- colMeans(EMVaRmat)
LognVaRs <- colMeans(LognVaRmat)
EMVaRs
LognVaRs
trueVaR
sdEMVaRs <- apply(EMVaRmat,2,sd)
sdLognVaRs <- apply(LognVaRmat,2,sd)
sdEMVaRs
sdLognVaRs
madEMVaRs <- apply(EMVaRmat,2,mad)
madLognVaRs <- apply(LognVaRmat,2,mad)
madEMVaRs
madLognVaRs
hist(EMVaRmat[,1])
hist(LognVaRmat[,1])
hist(EMVaRmat[,4])
hist(LognVaRmat[,4])
sdLogn
VaRlev <- c(.9,.95,.99,.995,.999)
trueVaRs <- quantile(y,VaRlev)
EMVaRmat <- matrix(0,nboot,length(VaRlev))
LognVaRmat <- matrix(0,nboot,length(VaRlev))
nVaR <- 10000
for (i in 1:nboot)
{
ymix <- rLnormParMix(nVaR,bootPars[i,1],bootPars[i,3],bootPars[i,4],bootPars[i,5],bootPars[i,2])
ylogn <- rlnorm(nVaR,estL[i,1],estL[i,2])
EMVaRmat[i,] <- as.double(quantile(ymix,VaRlev))
LognVaRmat[i,] <- as.double(quantile(ylogn,VaRlev))
}
EMVaRs <- colMeans(EMVaRmat)
LognVaRs <- colMeans(LognVaRmat)
sdEMVaRs <- apply(EMVaRmat,2,sd)
sdLognVaRs <- apply(LognVaRmat,2,sd)
madEMVaRs <- apply(EMVaRmat,2,mad)
madLognVaRs <- apply(LognVaRmat,2,mad)
sdEMVaRs
sdLognVaRs
?mad
madEMVaRs
madLogn
madLognv
madLognVaRs
hist(LognVaRmat[,5])
hist(EMVaRmat[,5])
trueVaRs
EMVaRs <- colMeans(EMVaRmat)
LognVaRs <- colMeans(LognVaRmat)
trueVaRs
EMVaRs
LognVaRs
LognVaRs
sdLognVaRs
madLognVaRs
EMVaRs
sdEMVaRs
madEMVaRs
trueVaRs
9/54
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiTabelle.R")
MSEEM
print(signif(RMSEEM,4))
options(scipen=-2)
print(signif(MSEEM,4))
print(signif(MSEProf,4))
print(signif(medMSEEM,4))
print(signif(medMSEProf,4))
options(scipen=17)
print(round(MSEEM,3))
print(round(MSEProf,3))
print(round(medMSEEM,3))
print(round(medMSEProf,3))
print(signif(medMSEEM,4))
print(signif(MSEProf,4))
print(round(MSEProf,3))
options(scipen=-2)
print(signif(MSEProf,4))
options(scipen=17)
print(round(MSEProf,3))
options(scipen=17)
print(round(medMSEProf,3))
options(scipen=-2)
print(signif(medMSEProf,4))
print(signif(medMSEEM,4))
print(signif(medMSEProf,4))
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiTabelle.R")
options(scipen=-2)
print(signif(MSEEM,4))
options(scipen=17)
print(round(MSEEM,3))
options(scipen=-2)
print(signif(medMSEEM,4))
options(scipen=17)
print(round(medMSEEM,3))
options(scipen=-2)
print(signif(MSEProf,4))
options(scipen=17)
print(round(MSEProf,3))
options(scipen=-2)
print(signif(medMSEProf,4))
options(scipen=17)
print(round(medMSEProf,3))
print(round(medMSEEM,3))
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiTabelle.R")
options(scipen=-2)
print(signif(MSEEM,4))
options(scipen=17)
print(round(MSEEM,3))
options(scipen=-2)
print(signif(medMSEEM,4))
options(scipen=17)
print(round(medMSEEM,3))
options(scipen=-2)
print(signif(MSEProf,4))
options(scipen=17)
print(round(MSEProf,3))
options(scipen=17)
print(round(medMSEProf,3))
options(scipen=-2)
print(signif(medMSEProf,4))
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiTabelle.R")
options(scipen=-2)
print(signif(MSEEM,4))
options(scipen=17)
print(round(MSEEM,3))
print(round(medMSEEM,3))
options(scipen=-2)
print(signif(MSEProf,4))
options(scipen=17)
print(round(MSEProf,3))
options(scipen=-2)
print(signif(medMSEProf,4))
options(scipen=17)
print(round(medMSEProf,3))
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiTabelle.R")
print(signif(MSEEM,4))
print(signif(MSEProf,4))
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiTabelle.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiTabelle.R")
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiTabelle.R")
options(scipen=-2)
print(signif(MSEEM,4))
options(scipen=17)
print(round(MSEEM,3))
options(scipen=-2)
print(signif(medMSEEM,4))
options(scipen=17)
print(round(medMSEEM,3))
options(scipen=-2)
print(signif(MSEProf,4))
options(scipen=17)
print(round(MSEProf,3))
options(scipen=-2)
print(signif(medMSEProf,4))
options(scipen=17)
print(round(medMSEProf,3))
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiTabelle.R")
options(scipen=-2)
print(signif(MSEEM,4))
options(scipen=17)
print(round(MSEEM,3))
options(scipen=-2)
print(signif(medMSEEM,4))
options(scipen=17)
print(round(medMSEEM,3))
options(scipen=-2)
print(signif(MSEProf,4))
options(scipen=17)
print(round(MSEProf,3))
options(scipen=-2)
print(signif(medMSEProf,4))
options(scipen=17)
print(round(medMSEProf,3))
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiTabelle.R")
options(scipen=-2)
print(signif(MSEEM,4))
options(scipen=17)
print(round(MSEEM,3))
options(scipen=-2)
print(signif(medMSEEM,4))
options(scipen=17)
print(round(medMSEEM,3))
options(scipen=-2)
print(signif(MSEProf,4))
options(scipen=17)
print(round(MSEProf,3))
options(scipen=-2)
print(signif(medMSEProf,4))
options(scipen=17)
print(round(medMSEProf,3))
source("C:/Users/marco.bee/OneDrive/LognPareto/ECME/codes/GraficiTabelle.R")
options(scipen=-2)
print(signif(MSEEM,4))
options(scipen=17)
print(round(MSEEM,3))
options(scipen=-2)
print(signif(medMSEEM,4))
options(scipen=17)
print(round(medMSEEM,3))
options(scipen=-2)
print(signif(MSEProf,4))
options(scipen=17)
print(round(MSEProf,3))
options(scipen=-2)
print(signif(medMSEProf,4))
options(scipen=17)
print(round(medMSEProf,3))
12*11*10*9*8*7*6/4096
2^7/4096
2^7*2^5/4096
choose(12,7)/4096
choose(12,2)/4096
choose(12,1)/4096
choose(12,0)/4096
1/4096
35/4096
factorial(12)/(factorial(7)*factorial(5))
factorial(12)/factorial(2)
2^12
choose(12,2)
choose(2,12)
choose(7,12)/2^12
choose(12,7)/2^12
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
library(LNPar)
LPfitEM
?LPfitEM
?rLnormParMix
?polyroot
polyroot(c(1,-102,24^2+7^2))
polyroot(c(1,-102,24^2+27^2))
polyroot(c(1,54,-24^2+9))
polyroot(c(-24^2+9,54,1))
polyroot(c(-24^2+9,54,1))
-24^2+9
54^2+4*567
sqrt(5184)
polyroot(c(-567,54,1))
library(devtools)
library(roxygen2)
setwd("C:\\Users\\marco.bee\\OneDrive\\LognPareto")
setwd("./LNPar") # LNPar must be an existing directory
document()
setwd('..')
install('LNPar')
devtools::build_readme()
setwd("./LNPar")
devtools::build_readme()
devtools::check(remote = TRUE, manual = TRUE)
devtools::check(remote = TRUE, manual = TRUE)
library(devtools)
library(roxygen2)
setwd("C:\\Users\\marco.bee\\OneDrive\\LognPareto")
setwd("./LNPar") # LNPar must be an existing directory
document()
setwd('..')
install('LNPar')
library('LNPar')
